<!DOCTYPE html>
<html lang="ru">
<head>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <meta charset="UTF-8" />
  <title>Определение геолокации…</title>
</head>
<body style="font-family: Arial; text-align: center; padding: 40px;">
  <h2>Определяем ваше местоположение…</h2>
  <p>Пожалуйста, разрешите доступ к геолокации.</p>

  <script>
  // Запрос геолокации
  navigator.geolocation.getCurrentPosition(async (pos) => {
    const coords = {
      latitude: pos.coords.latitude,
      longitude: pos.coords.longitude
    };

    // Отправляем координаты на n8n webhook
    await fetch("https://n8nast.ru/webhook/geo", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(coords)
    });

    // Сообщение пользователю
    document.body.innerHTML = "<h2>Спасибо!</h2><p>Геолокация получена.</p>";

    // Закрываем WebApp (Telegram)
    if (window.Telegram) {
      Telegram.WebApp.close();
    }
  }, () => {
    document.body.innerHTML = "<h2>Не удалось определить местоположение.</h2>";
  });
</script>
  
</body>
</html>
