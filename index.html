<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ‚Ä¶</title>
  <style>
    body {
      font-family: Arial;
      text-align: center;
      padding: 30px;
    }
    button {
      padding: 15px 25px;
      font-size: 18px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h2>–î–ª—è –ø–æ–¥–±–æ—Ä–∞ –º–∞—Å—Ç–µ—Ä–∞ –ø–æ —Ä–µ–º–æ–Ω—Ç—É</h2>
  <p>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–∞—à —Ä–∞–π–æ–Ω</p>

  <button onclick="getLocation()">üìç –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ</button>

  <p id="status"></p>

  <script>
    async function getLocation() {
      const status = document.getElementById('status');
      status.innerText = '–ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é...';

      navigator.geolocation.getCurrentPosition(async (pos) => {

        const coords = {
          latitude: pos.coords.latitude,
          longitude: pos.coords.longitude
        };

        status.innerText = '–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º...';

        // –ó–ê–ú–ï–ù–ò –≠–¢–û –í–°–ï–ì–î–ê!
        await fetch("https://n8nast.ru/webhook/geo", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(coords)
        });

        status.innerText = '–ì–æ—Ç–æ–≤–æ! –ú–æ–∂–µ—Ç–µ –∑–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–æ.';

        setTimeout(() => {
          Telegram.WebApp.close();
        }, 800);

      }, (err) => {
        status.innerText = '‚ö† –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é';
      });
    }
  </script>
</body>
</html>
